!function(e,t){"function"==typeof define&&define.amd?define([],(function(){return t(e)})):"object"==typeof exports?module.exports=t(e):e.simpleParallax=t(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(e){"use strict";var t=function(){for(var e,t="transform webkitTransform mozTransform oTransform msTransform".split(" "),i=0;void 0===e;)e=null!=document.createElement("div").style[t[i]]?t[i]:void 0,i++;return e}();!function(){for(var t=0,i=["ms","moz","webkit","o"],n=0;n<i.length&&!e.requestAnimationFrame;++n)e.requestAnimationFrame=e[i[n]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[i[n]+"CancelAnimationFrame"]||e[i[n]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(i,n){var s=(new Date).getTime(),a=Math.max(0,16-(s-t)),l=e.setTimeout((function(){i(s+a)}),a);return t=s+a,l}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){clearTimeout(e)})}(),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});let i,n,s,a,l=[],o=-1,r=!1;class h{constructor(e,t){this.element=e,this.elementContainer=e,this.defaults={delay:.6,orientation:"up",scale:1.3,overflow:!1,transition:"cubic-bezier(0,0,0,1)",breakpoint:!1},this.settings=Object.assign(this.defaults,t),this.settings.breakpoint&&document.documentElement.clientWidth<=this.settings.breakpoint||(this.init=this.init.bind(this),this.animationFrame=this.animationFrame.bind(this),this.handleResize=this.handleResize.bind(this),this.isImageLoaded(this.element)?this.init():this.element.addEventListener("load",this.init),l.push(this),r||(r=!0,this.getViewportOffsetHeight(),this.animationFrame()))}init(){this.isInit||(!1===this.settings.overflow&&this.wrapElement(),this.setStyle(),this.getElementOffset(),this.getTranslateValue(),this.animate(),e.addEventListener("resize",this.handleResize),this.isInit=!0)}isImageLoaded(){return!!this.element.complete&&(void 0===this.element.naturalWidth||0!==this.element.naturalWidth)}isVisible(){return this.elementBottomX>i&&this.elementTopX<n}wrapElement(){let e=this.element.closest("picture")||this.element;const t=document.createElement("div");t.classList.add("simpleParallax"),e.parentNode.insertBefore(t,e),t.appendChild(e),this.elementContainer=t}unWrapElement(){let e=this.elementContainer.parentNode;if(e){for(;this.elementContainer.firstChild;)e.insertBefore(this.elementContainer.firstChild,this.elementContainer);e.removeChild(this.elementContainer)}}setStyle(){!1===this.settings.overflow&&(this.element.style[t]="scale("+this.settings.scale+")"),this.settings.delay>0&&(this.element.style.transition="transform "+this.settings.delay+"s "+this.settings.transition),this.element.style.willChange="transform"}unSetStyle(){this.element.style.willChange="",this.element.style[t]="",this.element.style.transition=""}getElementOffset(){let t=this.elementContainer.getBoundingClientRect();this.elementHeight=t.height,this.elementTopX=t.top+e.pageYOffset,this.elementBottomX=this.elementHeight+this.elementTopX}getViewportOffsetTop(){i=e.pageYOffset}getViewportOffsetHeight(){s=document.documentElement.clientHeight}getViewportOffsetBottom(){n=i+s}handleResize(){this.getViewportOffsetHeight(),this.getElementOffset(),this.getRangeMax()}getRangeMax(){let e=this.element.clientHeight;this.rangeMax=e*this.settings.scale-e,"down"!==this.settings.orientation&&"right"!==this.settings.orientation||(this.rangeMax*=-1)}getTranslateValue(){let e=((n-this.elementTopX)/((s+this.elementHeight)/100)).toFixed(1);return e=Math.min(100,Math.max(0,e)),this.oldPercentage!==e&&(this.rangeMax||this.getRangeMax(),this.translateValue=(e/20*this.rangeMax-this.rangeMax/2).toFixed(0),this.oldTranslateValue!==this.translateValue&&(this.oldPercentage=e,this.oldTranslateValue=this.translateValue,!0))}animate(){let e,i=0,n=0;"left"===this.settings.orientation||"right"===this.settings.orientation?n=this.translateValue+"px":i=this.translateValue+"px",e=!1===this.settings.overflow?"translate3d("+n+", "+i+", 0) scale(1)":"translate3d("+n+", "+i+", 0)",this.element.style[t]=e}proceedElement(e){e.isVisible()&&e.getTranslateValue()&&e.animate()}animationFrame(){if(this.getViewportOffsetTop(),o!==i){this.getViewportOffsetBottom();for(let e=0;e<l.length;e++)this.proceedElement(l[e]);a=e.requestAnimationFrame(this.animationFrame),o=i}else a=e.requestAnimationFrame(this.animationFrame)}get isDestroyed(){return-1===l.indexOf(this)}destroy(){this.isDestroyed||(this.unSetStyle(),!1===this.settings.overflow&&this.unWrapElement(),l.splice(l.indexOf(this),1),l.length||(r=!1,e.cancelAnimationFrame(a)),e.removeEventListener("resize",this.handleResize))}}return function(e,t){let i=[];if(e.length)for(var n=0;n<e.length;n++)i.push(new h(e[n],t));else i.push(new h(e,t));return i}}));